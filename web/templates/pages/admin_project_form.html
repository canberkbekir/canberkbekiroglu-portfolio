{{define "admin_content"}}
<div class="admin-page-header">
    <h1 class="admin-page-title">{{if .IsEdit}}Edit Project{{else}}New Project{{end}}</h1>
    <a href="/admin/projects" class="admin-btn admin-btn--ghost">Back to Projects</a>
</div>

<form method="POST" action="{{if .IsEdit}}/admin/projects/{{.Project.ID}}/edit{{else}}/admin/projects/new{{end}}" class="admin-form">
    <input type="hidden" name="_csrf" value="{{.CSRFToken}}">

    <div class="admin-form-row">
        <div class="admin-form-group">
            <label class="admin-form-label" for="title">Title</label>
            <input type="text" id="title" name="title" class="admin-form-input" required
                   value="{{if .IsEdit}}{{.Project.Title}}{{end}}">
        </div>
        <div class="admin-form-group">
            <label class="admin-form-label" for="slug">Slug</label>
            <input type="text" id="slug" name="slug" class="admin-form-input" required
                   value="{{if .IsEdit}}{{.Project.Slug}}{{end}}"
                   pattern="[a-z0-9\-]+" title="Lowercase letters, numbers, and hyphens only">
        </div>
    </div>

    <div class="admin-form-row">
        <div class="admin-form-group">
            <label class="admin-form-label" for="year">Year</label>
            <input type="number" id="year" name="year" class="admin-form-input" required min="2000" max="2099"
                   value="{{if .IsEdit}}{{.Project.Year}}{{else}}{{currentYear}}{{end}}">
        </div>
        <div class="admin-form-group">
            <label class="admin-form-label" for="category">Category</label>
            <input type="text" id="category" name="category" class="admin-form-input"
                   value="{{if .IsEdit}}{{.Project.Category}}{{end}}">
        </div>
    </div>

    <div class="admin-form-group">
        <label class="admin-form-label" for="description">Description</label>
        <textarea id="description" name="description" class="admin-form-textarea" rows="3">{{if .IsEdit}}{{.Project.Description}}{{end}}</textarea>
    </div>

    <div class="admin-form-row">
        <div class="admin-form-group">
            <label class="admin-form-label" for="image">Image URL</label>
            <input type="text" id="image" name="image" class="admin-form-input"
                   value="{{if .IsEdit}}{{.Project.Image}}{{end}}"
                   placeholder="/static/media/...">
        </div>
        <div class="admin-form-group">
            <label class="admin-form-label" for="hover_image">Hover Image URL</label>
            <input type="text" id="hover_image" name="hover_image" class="admin-form-input"
                   value="{{if .IsEdit}}{{.Project.HoverImage}}{{end}}"
                   placeholder="/static/media/gifs/...">
        </div>
    </div>

    <div class="admin-form-row">
        <div class="admin-form-group">
            <label class="admin-form-label" for="company">Company</label>
            <input type="text" id="company" name="company" class="admin-form-input"
                   value="{{if .IsEdit}}{{.Project.Company}}{{end}}">
        </div>
        <div class="admin-form-group">
            <label class="admin-form-label" for="role">Role</label>
            <input type="text" id="role" name="role" class="admin-form-input"
                   value="{{if .IsEdit}}{{.Project.Role}}{{end}}">
        </div>
    </div>

    <div class="admin-form-group">
        <label class="admin-form-label" for="external_url">External URL (optional)</label>
        <input type="url" id="external_url" name="external_url" class="admin-form-input"
               value="{{if .IsEdit}}{{.Project.ExternalURL}}{{end}}"
               placeholder="https://...">
    </div>

    <div class="admin-form-group">
        <label class="admin-form-label" for="tags">Tech Tags (comma-separated)</label>
        <input type="text" id="tags" name="tags" class="admin-form-input"
               value="{{if .IsEdit}}{{join .Project.Tags ", "}}{{end}}"
               placeholder="Unity, C#, Networking">
    </div>

    <div class="admin-form-row">
        <div class="admin-form-group">
            <label class="admin-form-label" for="sort_order">Sort Order</label>
            <input type="number" id="sort_order" name="sort_order" class="admin-form-input"
                   value="{{if .IsEdit}}{{.Project.SortOrder}}{{else}}0{{end}}">
        </div>
        <div class="admin-form-group">
            <label class="admin-form-label">&nbsp;</label>
            <label class="admin-form-checkbox">
                <input type="checkbox" name="highlighted" {{if and .IsEdit .Project.Highlighted}}checked{{end}}>
                <span>Highlighted</span>
            </label>
        </div>
    </div>

    <div class="admin-form-group">
        <label class="admin-form-label">Sections</label>
        <div class="admin-checkbox-grid">
            {{range $sec := $.Sections}}
            <label class="admin-checkbox-label">
                <input type="checkbox" name="sections" value="{{$sec.ID}}"
                    {{if $.IsEdit}}{{$sid := $sec.ID}}{{range $.Project.SectionIDs}}{{if eq . $sid}}checked{{end}}{{end}}{{end}}>
                <span>{{$sec.Name}}</span>
            </label>
            {{end}}
        </div>
    </div>

    <div class="admin-form-group">
        <label class="admin-form-label">Filter Tags</label>
        <div class="admin-checkbox-grid">
            {{range $.FilterTags}}
            <label class="admin-checkbox-label">
                <input type="checkbox" name="filter_tags" value="{{.Slug}}"
                    {{if $.IsEdit}}{{$slug := .Slug}}{{range $.Project.FilterTags}}{{if eq . $slug}}checked{{end}}{{end}}{{end}}>
                <span>{{.Label}}</span>
            </label>
            {{end}}
        </div>
    </div>

    <div style="display:flex;gap:12px;margin-top:24px;">
        <button type="submit" class="admin-btn admin-btn--primary">
            {{if .IsEdit}}Update Project{{else}}Create Project{{end}}
        </button>
        <a href="/admin/projects" class="admin-btn admin-btn--ghost">Cancel</a>
    </div>
</form>
{{end}}
